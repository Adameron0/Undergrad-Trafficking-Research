#Step
z = eta + (Y-mu)/mu
lmod3 = lm(z~.-Endemics-Species, weights = w, data = gala)
lmod3$coef - pmod1$coef
for (i in 1:5){
deviance = 2*sum(y*log(y)-y*eta-(y-exp(eta)))
# Initialize
y = lmod3$fit
eta = y
mu = exp(eta)
w = mu
#Step
z = eta + (Y-mu)/mu
lmod3 = lm(z~.-Endemics-Species, weights = w, data = gala)
cat(i,deviance,"\n")
}
lmod3$coefficients
summary(lmod3)$coef
summary(lmod3)$coef[,2]
summary(lmod3)$coef[,2]
summary(lmod3)$coef
summary(lmod3)$coef[,2]
summary(pmod1)$coef[,2]
summary(lmod3)$coef[,2]
log(summary(pmod1)$coef[,2])
summary(pmod1)$coef[,2]
summary(lmod3)$coef[,2]
library(faraway)
data(gala)
data("worldcup")
help(worldcup)
head(worldcup)
pmod2 = glm(Shots~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes,# + offset(Time),
family = poisson, data = worldcup)
pmod2
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
pmod2
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
pmod2
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles")]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles", "Passes"),]
summary(pmod2)$hat
hatvalues(pmod2)
max(hatvalues(pmod2))
hv = hatvalues(pmod2)
hv[which(hv = max(hv)]
hv = hatvalues(pmod2)
hv[which(hv = max(hv))]
hv = hatvalues(pmod2)
hv[which.max(hv)]
which
hv = hatvalues(pmod2)
hv[which.max(hv)]
worldcup[c("Xavi"),]
as.vector(worldcup[c("Xavi"),])
as.matrix(worldcup[c("Xavi"),])
halfnorm(hv)
worldcup[c("Xavi"),]
halfnorm(hv, xlab = "Hat Value")
halfnorm(hv, x.lab = "Hat Value")
halfnorm(hv, xlab = c("Hat Value"))
halfnorm(hv)
halfnorm(hv. ylab = "Y")
halfnorm(hv. ylab = c("Y"))
halfnorm(hv)
boxplot(hv)
halfnorm(hv)
rstudent(pmod2)
for (i in 1:5){
deviance = 2*sum(y*log(y)-y*eta-(y-exp(eta)))
# Initialize
y = lmod3$fit
eta = y
mu = exp(eta)
w = mu
#Step
z = eta + (Y-mu)/mu
lmod3 = lm(z~.-Endemics-Species, weights = w, data = gala)
cat(i,deviance,"\n")
}
for (i in 1:5){
deviance = deviance(lmod3)
# Initialize
y = lmod3$fit
eta = y
mu = exp(eta)
w = mu
#Step
z = eta + (Y-mu)/mu
lmod3 = lm(z~.-Endemics-Species, weights = w, data = gala)
cat(i,deviance,"\n")
}
influence(pmod2)
influence(pmod2)$coefficients
influence(pmod2)$coefficients[,c("Tackles")]
tackinf[which.max(tackinf)]
tackinf = influence(pmod2)$coefficients[,c("Tackles")]
tackinf[which.max(tackinf)]
tackinf = influence(pmod2)$coefficients[,c("Tackles")]
tackinf[which.max(abs(tackinf))]
plot(tackinf)
boxplot(tackinf)
boxplot(std(tackinf))
boxplot(standad(tackinf))
boxplot(standard(tackinf))
boxplot(scale(tackinf))
boxplot(tackinf)
plot(tackinf)
plot(tackinf, ylab = "Change in Tackle Coefficient")
plot(tackinf, ylab = "Change in Tackle Coefficient")
cooks.distance(pmod2)
cd[which.max(cd)]
cd = cooks.distance(pmod2)
cd[which.max(cd)]
plot(pmod2)
cd = cooks.distance(pmod2)
cd[which.max(cd)]
halfnorm(rstudent(modpl))
halfnorm(rstudent(pmod2))
halfnorm(rstudent(pmod2), ylab = "Jackknife Residuals")
rs = rstudent(pmod2)
rs[which.max(abs(rs))]
as.marix(worldcup)[c("Busquets"),]
as.matrix(worldcup)[c("Busquets"),]
plot(pmod2$fitted.values, rs)
plot(Shots~Tackles, data = worldcup)
plot(Shots/Time~Tackles/Time, data =- worldcup)
plot(Shots~Tackles, data = worldcup)
plot(Shots/Time~I(Tackles/Time), data =- worldcup)
plot(Shots~Tackles, data = worldcup)
plot(Shots/Time~I(Tackles/Time), data = worldcup)
plot(scale(Shots)~I(Tackles/Time), data = worldcup)
termplot(pmod2,partial=TRUE,terms=1)
termplot(pmod2$Tackles,partial=TRUE,terms=1)
termplot(pmod2,partial=TRUE,terms="Tackles")
plot(worldcup$Shots)
histogram(worldcup$Shots)
hist(worldcup$Shots)
hist(worldcup$Shots, bins = 4)
hist(worldcup$Shots, bin = 4)
hist(worldcup$Shots, breaks = 10)
hist(worldcup$Shots, breaks = 100)
hist(worldcup$Shots, breaks = 13)
hist(scale(worldcup$Shots), breaks = 13)
hist(scale(worldcup$Shots), breaks = 15)
hist(scale(worldcup$Shots), breaks = 15)
dpois(x, lambda, add = True)
hist(scale(worldcup$Shots), breaks = 15)
dpois(x, lambda)
hist(scale(worldcup$Shots), breaks = 15)
dpois(worldcup$Shots, 2)
hist(dpois(worldcup$Shots, 2))
hist(dpois(mean(worldcup$Shots), 2))
hist(scale(worldcup$Shots), breaks = 15)
hist(scale(worldcup$Shots), breaks = 15)
plot(worldcup$Shots, dpois(0:8, lambda=5), type='h')
plot(worldcup$Shots, dpois(0:8, lambda=mean(worldcup$Shots)), type='h')
hist(scale(worldcup$Shots), breaks = 15)
plot(worldcup$Shots, dpois(0:nrow(worldcup), lambda=mean(worldcup$Shots)), type='h')
plot(worldcup$Shots, dpois(0:nrow(worldcup), lambda=mean(worldcup$Shots)), type='h')
hist(scale(worldcup$Shots), breaks = 15)
plot(dpois(x=1:7,lambda=3))
hist(scale(worldcup$Shots), breaks = 15)
plot(dpois(x=1:7,lambda=3), add = True)
hist(scale(worldcup$Shots), breaks = 15)
points(dpois(x=1:7,lambda=3), add = True)
hist(scale(worldcup$Shots), breaks = 15)
points(dpois(x=1:7,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(dpois(x=1:7,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(dpois(x=1:25,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(400*dpois(x=1:25,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(4000*dpois(x=1:25,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(900*dpois(x=1:25,lambda=3))
hist(worldcup$Shots, breaks = 15)
points(400*dpois(x=1:25,lambda=mean(worldcup$Shots)))
hist(worldcup$Shots, breaks = 19)
points(400*dpois(x=1:25,lambda=mean(worldcup$Shots)))
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=1:25,lambda=mean(worldcup$Shots)))
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=1:25,lambda=mean(worldcup$Shots)), type = "l")
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=seq(0,25,0.01),lambda=mean(worldcup$Shots)), type = "l")
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=seq(0,25,1),lambda=mean(worldcup$Shots)), type = "l")
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=seq(0,25,0.5),lambda=mean(worldcup$Shots)), type = "l")
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l")
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l", cel = 2)
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l", cex = 2)
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l", cex = 20)
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l", lwd = 2)
hist(worldcup$Shots, breaks = 25)
points(400*dpois(x=0:25,lambda=mean(worldcup$Shots)), type = "l", lwd = 2, col = "navy")
hist(worldcup$Shots, breaks = 25)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes, + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles", "Passes"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
data("worldcup")
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(log(Time)),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles", "Passes"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
worldcup[c("Forlan"),]
which(worldcup[c("Forlan"),])
worldcup[c("Forlan"),]
halfnorm(hv)
tackinf = influence(pmod2)$coefficients[,c("Tackles")]
tackinf[which.max(abs(tackinf))]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + Tackles + Passes + offset(Time),
family = poisson, data = worldcup)
#help(worldcup)
head(worldcup)
unique(worldcup$Position)
#help(worldcup)
head(worldcup)
help(worldcup)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper")]
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + offset(Time),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles", "Passes"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + offset(log(Time)),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("Tackles", "Passes"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + offset(log(Time)),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
worldcup[c("Villa"),]
halfnorm(hv)
tackinf = influence(pmod2)$coefficients[,c("Tackles")]
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
plot(tackinf, ylab = "Change in Tackle Coefficient")
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + offset(TackleRate) + offset(PassRate),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + offset(TackleRate) + offset(PassRate),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + offset(log(TackleRate)) + offset(log(PassRate)),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + offset(90),
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + offset(rep(90,nrow(worldcup))),
family = poisson, data = worldcup)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
hist(hv)
hv = hatvalues(pmod2)
hv[which.max(hv)]
halfnorm(hv)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),-c("Saves")]
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),][,-c("Saves")]
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),][,c("Saves")]
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),]
data("worldcup")
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup2
worldcup2$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup2
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup2$Time/90)
head(worldcup2)
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup2 = worldcup2[-c("Saves")]
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup2 = worldcup2[,-c("Saves")]
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),]
worldcup2 = worldcup2[-c("Saves"),]
head(worldcup2)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),]
head(worldcup)
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),-c(7)]
head(worldcup)
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
head(worldcup)
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
data("worldcup")
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
head(worldcup)
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
worldcup = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
head(worldcup)
worldcup$TackleRate = worldcup$Tackles/(worldcup$Time/90)
worldcup$PassRate = worldcup$Passes/(worldcup$Time/90)
head(worldcup)
data("worldcup")
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
head(worldcup2)
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup22$Time/90)
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
head(worldcup2)
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup2$Time/90)
head(worldcup2)
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup2$Time/90)
head(worldcup2)
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup2$Time/90)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(log(Time)) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
halfnorm(hv)
summary(pmod2)
hv = hatvalues(pmod2)
hv[which.max(hv)]
hist(hv)
hist(hv, breaks = 25)
hist(hv, breaks = 250)
hist(hv, breaks = 30)
hv = hatvalues(pmod2)
hv[which.max(hv)]
halfnorm(hv)
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
worldcup2[c("Villa"),]
worldcup2[c("Mascherano"),]
pmod2 = glm(Shots ~ offset(log(Time)) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
plot(tackinf, ylab = "Change in Tackle Coefficient")
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time/90) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time/2) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 20)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 25)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 250)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 100)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 150)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 125)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 130)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 140)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 145)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 150)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 147)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 146)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 147)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 1)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2, maxit = 0)
pmod2 = glm(Shots ~ offset(Time) + factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + offset(TackleRate) + offset(PassRate),
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(log(Shots) ~ factor(Team) + factor(Position) + offset(TackleRate) + offset(PassRate),
family = poisson, data = worldcup2)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + offset(TackleRate) + offset(PassRate),
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate + Time,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
worldcup2 = worldcup[-which(worldcup$Position == "Goalkeeper"),][-c(7)]
worldcup2$TackleRate = worldcup2$Tackles/(worldcup2$Time/90)
worldcup2$PassRate = worldcup2$Passes/(worldcup2$Time/90)
pmod2 = glm(Shots ~ factor(Team) + factor(Position) + TackleRate + PassRate,
family = poisson, data = worldcup2)
summary(pmod2)$coef[c("TackleRate", "PassRate"),]
hv = hatvalues(pmod2)
hv[which.max(hv)]
worldcup2[c("Amoah"),]
halfnorm(hv)
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max((tackinf))]
tackinf = influence(pmod2)$coefficients[,c("TackleRate")]
tackinf[which.max(abs(tackinf))]
plot(tackinf, ylab = "Change in Tackle Coefficient")
cd = cooks.distance(pmod2)
cd[which.max(cd)]
worldcup2[c("Amoah"),]
worldcup2[c("Gyan"),]
halfnorm(rstudent(pmod2), ylab = "Jackknife Residuals")
rs = rstudent(pmod2)
rs[which.max(abs(rs))]
plot(pmod2$fitted.values, rs)
plot(Shots~Tackles, data = worldcup)
plot(Shots/Time~I(Tackles/Time), data = worldcup)
plot(scale(Shots)~I(Tackles/Time), data = worldcup)
plot(Shots~Tackles, data = worldcup2)
plot(Shots/Time~TackleRate, data = worldcup2)
plot(scale(Shots)~TackleRate, data = worldcup2)
termplot(pmod2,partial=TRUE,terms="Tackles")
termplot(pmod2,partial=TRUE,terms="TackleRate")
hist(worldcup$Shots, breaks = 25)
hist(worldcup2$Shots, breaks = 25)
plot(pmod2)
hist(worldcup2$Shots, breaks = 25)
plot(pmod2, which = c(2))
